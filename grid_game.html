<!doctype html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>Experiment Factory Game</title>
        
        
<script src='https://cdnjs.cloudflare.com/ajax/libs/phaser/2.4.6/phaser.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.0/jquery.min.js'></script>
<script src='static/games/grid_game/box2d-plugin-full.min.js'></script>
<script src='static/games/grid_game/Boot.js'></script>
<script src='static/games/grid_game/Preloader.js'></script>
<script src='static/games/grid_game/Menu.js'></script>
<script src='static/games/grid_game/Instructions.js'></script>
<script src='static/games/grid_game/Run.js'></script>
<script src='static/games/grid_game/problems.js'></script>
<script src='static/games/grid_game/lodash.js'></script>
    </head>
    <body>
    <script type="text/javascript">

    this.data = {}
    this.taskdata = []

    function inputData(field, value) {
        this.data[field] = value
    }


    function sendData(trial) {
        inputData('trial', trial)
        this.taskdata.push(this.data);
       
        if (data.finished == 1) {

            setTimeout(function() { 
                var data = "text/json;charset=utf-8," + JSON.stringify(this.taskdata);
                var a = document.createElement('a');
                a.title = "Download"
                a.id = "download"
                a.type = "button"
                a.download = 'expfactory_result.json';
                a.href = 'data:' + data;
                $("#finished").show();
                $("#download").click(function(){
                    $("body").append(a)
                    a.click()
                })
            },2000)
        }

        this.data = {};

    }

    window.onload = function() {

      //create the game and the game states
var game = new Phaser.Game(960, 600, Phaser.CANVAS, 'gameContainer')
problem_set='A'
game.state.add('Boot', Game.Boot)
game.state.add('Preloader', Game.Preloader)
game.state.add('Menu',Game.Menu)
game.state.add('Instructions', Game.Instructions)
game.state.add('Run', Game.Run)
//Now start the Boot state.
game.state.start('Boot', true, false, problem_set)


    }

    </script>
    <div id="finished" hidden>
      <button id="download" type="button" style="background-color:white;padding:10px; border-radius:5px">Download</button>
    </div>
    </body>
    
</html>
